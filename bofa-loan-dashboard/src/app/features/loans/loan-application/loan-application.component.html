<div class="loan-application-page">
  <div class="page-header">
    <h2>New Loan Application</h2>
    <a routerLink="/loans" class="back-link">‚Üê Cancel</a>
  </div>

  <form [formGroup]="applicationForm" (ngSubmit)="onSubmit()" class="application-form">
    @if (errorMessage) {
      <div class="error-message">{{ errorMessage }}</div>
    }

    <div class="form-section">
      <h3>Applicant Information</h3>
      <div class="form-group">
        <label>Applicant Name *</label>
        <input type="text" formControlName="applicantName" placeholder="Full name" />
        @if (f['applicantName'].invalid && f['applicantName'].touched) {
          <div class="validation-error">Name is required (min 2 characters)</div>
        }
      </div>
    </div>

    <div class="form-section">
      <h3>Loan Details</h3>
      <div class="form-row">
        <div class="form-group">
          <label>Loan Amount *</label>
          <input type="number" formControlName="amount" placeholder="e.g. 50000" />
          @if (f['amount'].invalid && f['amount'].touched) {
            <div class="validation-error">Amount required ($1,000 - $10,000,000)</div>
          }
        </div>

        <div class="form-group">
          <label>Interest Rate (%) *</label>
          <input type="number" step="0.01" formControlName="interestRate" placeholder="e.g. 5.5" />
          @if (f['interestRate'].invalid && f['interestRate'].touched) {
            <div class="validation-error">Rate required (0% - 30%)</div>
          }
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Term (months) *</label>
          <input type="number" formControlName="term" placeholder="e.g. 36" />
          @if (f['term'].invalid && f['term'].touched) {
            <div class="validation-error">Term required (6 - 360 months)</div>
          }
        </div>

        <div class="form-group">
          <label>Loan Type *</label>
          <select formControlName="type">
            <option value="">Select type</option>
            @for (type of loanTypes; track type.value) {
              <option [value]="type.value">{{ type.label }}</option>
            }
          </select>
          @if (f['type'].invalid && f['type'].touched) {
            <div class="validation-error">Type is required</div>
          }
        </div>
      </div>
    </div>

    <div class="form-section">
      <h3>Risk Assessment</h3>
      <div class="form-group">
        <label>Risk Score (0-100) *</label>
        <input type="number" formControlName="riskScore" placeholder="50" />
        @if (f['riskScore'].invalid && f['riskScore'].touched) {
          <div class="validation-error">Score required (0 - 100)</div>
        }
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="btn-secondary" routerLink="/loans">Cancel</button>
      <button type="submit" class="btn-primary" [disabled]="loading || applicationForm.invalid">
        {{ loading ? 'Submitting...' : 'Submit Application' }}
      </button>
    </div>
  </form>
</div>
