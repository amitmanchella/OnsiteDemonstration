@if (!loading && loan) {
  <div class="loan-detail-page">
  <div class="page-header">
    <h2>Loan Details</h2>
    <a routerLink="/loans" class="back-link">‚Üê Back to Loans</a>
  </div>

  <div class="detail-grid">
    <div class="detail-card applicant-info">
      <h3>Applicant Information</h3>
      <div class="info-row">
        <span class="label">Name:</span>
        <span class="value">{{ loan.applicantName }}</span>
      </div>
      <div class="info-row">
        <span class="label">Application Date:</span>
        <span class="value">{{ loan.applicationDate | date:'mediumDate' }}</span>
      </div>
    </div>

    <div class="detail-card loan-terms">
      <h3>Loan Terms</h3>
      <div class="info-row">
        <span class="label">Amount:</span>
        <span class="value">{{ loan.amount | currencyFormat }}</span>
      </div>
      <div class="info-row">
        <span class="label">Interest Rate:</span>
        <span class="value">{{ loan.interestRate }}%</span>
      </div>
      <div class="info-row">
        <span class="label">Term:</span>
        <span class="value">{{ loan.term }} months</span>
      </div>
      <div class="info-row">
        <span class="label">Type:</span>
        <span class="value">{{ loan.type }}</span>
      </div>
    </div>

    <div class="detail-card status-card">
      <h3>Status & Risk</h3>
      <div class="info-row">
        <span class="label">Current Status:</span>
        <span class="status-badge" [class]="'status-' + loan.status">{{ loan.status }}</span>
      </div>
      @if (loan.approvedBy) {
      <div class="info-row">
        <span class="label">Approved By:</span>
        <span class="value">{{ loan.approvedBy }}</span>
      </div>
      }
      <div class="info-row">
        <span class="label">Risk Score:</span>
        <span class="risk-score" [class.high]="loan.riskScore > 70">{{ loan.riskScore }}</span>
      </div>

      @if (loan.status === 'pending') {
      <div class="status-update">
        <label>Update Status:</label>
        <select #statusSelect (change)="updateStatus(statusSelect.value)">
          <option value="">Select...</option>
          <option value="approved">Approve</option>
          <option value="rejected">Reject</option>
        </select>
      </div>
      }
    </div>
  </div>

  <div class="transactions-section">
    <h3>Transaction History</h3>
    @if (transactions.length) {
    <table class="transactions-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Type</th>
          <th>Description</th>
          <th>Amount</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        @for (tx of transactions; track tx.id) {
        <tr>
          <td>{{ tx.date | date:'mediumDate' }}</td>
          <td>{{ tx.type }}</td>
          <td>{{ tx.description }}</td>
          <td>{{ tx.amount | currencyFormat }}</td>
          <td>
            <span class="tx-status" [class]="'tx-' + tx.status">{{ tx.status }}</span>
          </td>
        </tr>
        }
      </tbody>
    </table>
    }
    @if (!transactions.length) {
    <p class="no-data">No transactions found</p>
    }
  </div>
  </div>
}

@if (loading) {
  <div class="loading">Loading loan details...</div>
}
